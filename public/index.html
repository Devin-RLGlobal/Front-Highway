<!DOCTYPE html>
<html lang="en">
<head>
  <script type="text/javascript" src="//dl.frontapp.com/libs/plugin-sdk-1.8.1.min.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Front Plugin</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>Front Plugin</h1>  
  <button id="move-email-btn">Quarantine Email</button>
  <div id="highway-data"></div>
  <script src="../src/front.js" type="module"></script>
  <script type="module">
    import { moveEmail } from '../src/front.js';
    window.addEventListener('highwayDataUpdated', (event) => {
  const data = event.detail?.dotSearch?.[0]?.[0] || {}; 

  window.addEventListener('highwayDataUpdated', (event) => {
  const data = event.detail?.dotSearch?.[0]?.[0] || {}; 

  const filteredData = {
    Title: data.legal_name ?? "N/A",
    Description: data.authority_assessment?.rating ?? "N/A",
    OverallResult: data.rules_assessment?.overall_result ?? "N/A",
    SafetyRating: data.safety?.safety_rating ?? "N/A",
    ContractStatus: data.authority?.authorities?.contract_authority_status ?? "N/A",
    CommonStatus: data.authority?.authorities?.common_authority_status ?? "N/A",
    BrokerStatus: data.authority?.authorities?.broker_authority_status ?? "N/A",
    ConnectionStatus: data.connection ?? "N/A",
    CarrierID: data.dot_number ?? "N/A",
    LegalName: data.legal_name ?? "N/A",
    MCNumber: data.mc_number ?? "N/A",
    DOTNumber: data.dot_number ?? "N/A",
    Address: `${data.addresses?.[0]?.street1 ?? "N/A"}, ${data.addresses?.[0]?.city ?? "N/A"}, ${data.addresses?.[0]?.state ?? "N/A"} ${data.addresses?.[0]?.postal_code ?? "N/A"}`,
    DispatchPhone: data.contact_information?.dispatch_contact?.phone ?? "N/A",
    DispatchEmail: data.contact_information?.dispatch_contact?.email_address ?? "N/A"
  };

  let plainText = '';
  for (const [key, value] of Object.entries(filteredData)) {
    plainText += `${key}: ${value}\n`;
  }

  // Display as plain text
  const container = document.getElementById('highway-data');
  container.innerText = plainText; // Use innerText instead of innerHTML
});




    document.getElementById('move-email-btn').addEventListener('click', () => {
      moveEmail();
    });

  </script>
</body>
</html>
